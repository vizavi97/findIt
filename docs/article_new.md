# Простой статический сайт на webpack 4

Данная статья является документацией к проекту [static-site-webpack-habr](https://github.com/Harrix/static-site-webpack-habr). С помощью пакета webpack под Node.js и других пакетов, включая HTML шаблонизатор, создается набор HTML страниц, которые удобно использовать для тестирования HTML шаблонов или для генерации простого статического сайта.

На Хабре находится старая версия [статьи](https://habr.com/ru/post/350886/). За это время некоторые подходы изменились, некоторые мои взгляды поменялись, пакеты обновились, а некоторые пакеты устарели. Так что в данной статье представлен сильно переработанный вариант.

## Постановка задачи

Сайт представляет собой простой набор HTML страниц со своим CSS стилями и файлом JavaScript. Необходимо написать проект, который бы собирал наш сайт из исходников:

- из SASS (точнее SCSS) файлов формируется один CSS файл;
- из различных JavaScript библиотек и пользовательского кода формируется один JavaScript файл;
- HTML страницы собираются с помощью шаблона, где содержимое шапки и футера можно разнести по отдельным файлам.

В собранном сайте не должны использоваться [React](https://reactjs.org/), [Vue.js](https://vuejs.org/), [Angular](https://angularjs.org/) и др. Причина заключается не в том, что я не люблю эти фреймворки, а хочу использовать универсальный подход без привязки к JavaScript фреймворку.

При выборе технологий выбираются по возможности наиболее популярные на данный момент. По этой причине отказался и от [Grunt](https://gruntjs.com/), и [Gulp](https://gulpjs.com/) в пользу [webpack](https://webpack.js.org/), хотя, если честно, синтаксис Gulp мне понравился больше своим однообразием.

Для примера будет сверстано несколько страничек на базе [Bootstrap 4](https://getbootstrap.com/). Но это только для примера.

Предполагается, что [Node.js](https://nodejs.org/) установлен (в Windows просто нужно скачать установщик и установить в стиле «далее, далее»), и вы умеете работать с командной строкой [CLI](https://ru.wikipedia.org/wiki/Интерфейс_командной_строки) (в Windows это `cmd` или `PowerShell`).

Нужно получить набор готовых HTML страниц, которые можно залить на хостинг без дополнительных настроек (например, на [GitHub Pages](https://pages.github.com/)) или открыть локально на компьютере.

## Структура проекта

Общая структура проекта представлена ниже:

```text
.
├── dist                 - папка, куда будет собираться сайт
├─┬ src                  - папка с исходниками сайта
│ ├── favicon            - папка с файлами иконок для сайта
│ ├── fonts              - папка со шрифтами
│ ├─┬ html               - папка шаблонов HTML страниц
│ │ ├── includes         - папка с встраиваемыми шаблонами (header, footer)
│ │ └── views            - папка с самими HTML страницами
│ ├── img                - папка с общими изображениями (логотип, иконки и др.)
│ ├── js                 - папка с JavaScript файлами
│ ├── scss               - папка с SСSS файлами
│ └── uploads            - папка с файлами статей (картинки, архивы и др.)
├── package-lock.json    - файл со списком версий пакетов (редактируется автоматически)
├── package.json         - файл настроек Node.js
└── webpack.config.js    - файл настроек webpack
```

Ниже приведена та же структура, но с отображением файлов, которые присутствуют в примере из данной статьи:

```text
.
├── dist
├─┬ src
│ ├─┬ favicon
│ │ └── favicon.ico
│ ├─┬ fonts
│ │ └── Roboto-Regular.ttf
│ ├─┬ html
│ │ ├─┬ includes
│ │ │ ├── footer.html
│ │ │ └── header.html
│ │ └─┬ views
│ │   ├── index.html
│ │   └── second.html
│ ├─┬ img
│ │ └── logo.svg
│ ├─┬ js
│ │ └── index.js
│ ├─┬ scss
│ │ └── style.scss
│ └─┬ uploads
│   └── test.jpg
├── package-lock.json
├── package.json
└── webpack.config.js
```

Спорным решением может показаться разделение изображений на две папки: `img` и `uploads`. Но здесь использовал идеологию расположения файлов из [Wordpress](https://ru.wordpress.org/), так как на мой взгляд, кидать все изображения в одну папку — это не очень хороший подход.

В папке проекта [static-site-webpack-habr](https://github.com/Harrix/static-site-webpack-habr) находятся также дополнительные служебные файлы и папки (например, папка `docs` с документацией к проекту, файл `README.md` с описанием проекта и др.). Но эти все остальные файлы и папки несут лишь служебную функцию, так что можно копировать и рассматривать только вышеприведенные.

При установке пакетов появится папка `node_modules` с установленными пакетами на основании информации из файлов `package.json` и `package-lock.json` (второй файл вы сами не трогаете, так как он генерируется Node.js на основании первого файла `package.json`). Эту папку не надо заливать на GitHub.

Для работы с проектом использую редактор [Visual Studio Code](https://code.visualstudio.com/), которым крайне доволен. Особенно мне нравится, что командная строка встроена в программу и вызывается через `Ctrl` + `` ` ``.

![Visual Studio Code с встроенной командной строкой](img/visual_studio_code.png)

Сделаем шаблон Node.js проекта. Для этого создадим папки проекта с вышеописанной структурой (`dist`, `src` и так далее) и перейдем в неё в командной строке, где вызовем команду для создания файла `package.json`:

```console
npm init
```

На предложенные программой вопросы можно не отвечать, нажимая  клавишу `Enter`, если заполнять подробную информацию не хочется (особенно для нашего тестового проекта).

После этого установим три пакета общего назначения, которые нам потребуются в любом случае: `webpack`, `webpack-cli` (работу с командной строкой в webpack вынесли в отдельный пакет) и `webpack-dev-server` (для запуска локального сервера, чтобы изменения проекта в браузере сразу отображались):

```console
npm install webpack webpack-cli webpack-dev-server --save-dev
```

Файл `package.json` у вас в текущий момент выглядит примерно так (версии пакетов у вас скорее всего будут другими, так как они постоянно обновляться):

```json
{
  "name": "static-site-webpack-habr",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "license": "ISC",
  "devDependencies": {
    "webpack": "^4.41.2",
    "webpack-cli": "^3.3.10",
    "webpack-dev-server": "^3.9.0"
  }
}
```

## Собираем JavaScript
